--- 
title: "BIOL 3295: Population and Evolutionary Ecology, Winter 2023"
author: "Amy Hurford"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: bookdown::gitbook
documentclass: book
biblio-style: apalike
link-citations: false 
---

# Syllabus
## Instructor Information

Instructor: Dr. Amy Hurford\
Office: CSF 4338\
Email: ahurford@mun.ca\
I will try to reply to emails within 24 hours (excluding evenings, weekends and holidays).
Office hours: Tuesday 1-2pm; Thursday 1-2pm

## Course Information	
TR 12.00-12.50pm\
F 1-1.50pm\
Classroom: SN3060\ (unless stated otherwise on the schedule)

All Course Announcements will be made on BrightSpace. Should lectures be remote a WebEx link will be provided on BrightSpace.


Course description:\
Population and Evolutionary Ecology is an introduction to the theory and principles of evolutionary ecology and population dynamics. Pre-requisites: BIOL 2600; at least one of BIOL 2010, 2122 or 2210.\
	
Course format:\
The course consists of lectures, 4 data analysis assignments, 2 exams and a final exam.\ 

Course expectations:\
Please attend lectures and respect the learning environment of other students. If you have COVID-19 please follow university and provincial public health guidelines.\
	    
Learning goals:\
The course content emphasizes a deeper understanding of fewer concepts. You have seen much of the course material in pre-requisite courses. In this course, I will revisit the models, clarify the assumptions and when they are appropriate, and we will fit the models to data to estimate parameters. By the end of the course, I hope that if you were given population data, that you would know the key quantities that you might estimate, and could complete the analysis.

Required Text and Resources:\
The course materials are online at https://ahurford.github.io/biol-3295-winter-2023/index.html.

Most readings are assigned from two textbooks that are available electronically from the library:

- Vandermeer, J.H., Goldberg, D.E., 2013. Population Ecology: First Principles (Second Edition). Princeton University Press, Princeton, United States. [Link](https://ebookcentral-proquest-com.qe2a-proxy.mun.ca/lib/mun/detail.action?docID=1205619)

- Otto, Sarah P., and Troy Day. 2007. A Biologist’s Guide to Mathematical Modeling in Ecology and Evolution, Princeton University Press. [Link](https://ebookcentral-proquest-com.qe2a-proxy.mun.ca/lib/mun/detail.action?docID=768551)

If you wish to use your own computer for assignments you should install `R` and `RStudio` (see also [here](https://ahurford.github.io/quant-guide-all-courses/install.html)).

## Method of Evaluation

- 4 Assignments - 20%\
- 2 Exams - 40%\
- Final Exam - 40%\

Late assignments and missed exams, and final exams will be accommodated as described by University Regulation 6.7.3 and 6.7.5 (see [https://www.mun.ca/regoff/calendar/sectionNo=REGS-0474](https://www.mun.ca/regoff/calendar/sectionNo=REGS-0474) for Regulations). Please discuss missed assignments and exams with me. To accommodate the absence an assignment may be modified or exempted and re-weighted in the grading scheme.

## Additional Policies
### Accommodation of students with disabilities
Memorial University of Newfoundland is committed to supporting inclusive education based on the principles of equity, accessibility and collaboration. Accommodations are provided within the scope of the University Policies for the Accommodations for Students with Disabilities see [www.mun.ca/policy/site/policy.php?id=239](www.mun.ca/policy/site/policy.php?id=239). Students who may need an academic accommodation are asked to initiate the request with the Glenn Roy Blundon Centre at the earliest opportunity (see [www.mun.ca/blundon](www.mun.ca/blundon) for more information). 

### Academic misconduct
Students are expected to adhere to those principles, which constitute proper academic conduct. A student has the responsibility to know which actions, as described under Academic Offences in the University Regulations, could be construed as dishonest or improper. Students found guilty of an academic offence may be subject to a number of penalties commensurate with the offence including reprimand, reduction of grade, probation, suspension or expulsion from the University. For more information regarding this policy, students should refer to University Regulation 6.12. 

### Equity and Diversity
A safe learning environment will be provided for all students regardless of race, colour, nationality, ethnic origin, social origin, religious creed, religion, age, disability, disfigurement, sex (including pregnancy), sexual orientation, gender identity, gender expression, marital status, family status, source of income or political opinion.

You should not photograph or record myself, teaching assistants, or other students in the class without first obtaining permission. Accommodation will be made for students with special needs.

The sound should be turned off on phones and computers during class.

## Additional Supports
Resources for additional support can be found at:

- [www.mun.ca/currentstudents/student/](www.mun.ca/currentstudents/student/)

- [https://munsu.ca/resource-centres/](https://munsu.ca/resource-centres/)




<!--chapter:end:index.Rmd-->

# Schedule {#schedule}

All lectures are in SN 3060 unless otherwise stated

- Thurs Jan 5: Introduction
- Fri Jan 6: Population biology with discrete and continuous variables
- Tues Jan 10: **CSF 2218** Introduction to Rmarkdown and tidyverse **Assignment 1 is assigned**
- Thurs Jan 12: Geometric growth
- Fri Jan 13: Geometric growth
- Tues Jan 17: **CSF 2218** Numerical solutions and graphing population data **Assignment 1 is due & Assignment 2 is assigned**
- Thurs Jan 19: Exponential growth
- Fri Jan 20: Exponential growth
- Tues Jan 24: Density dependence and logistic growth
**Assignment 2 is due**
- Thurs Jan 26: Density dependence and logistic growth
- Fri Jan 27: Density dependence and logistic growth
- Tues Jan 31: Discrete time density dependence
- Thurs Feb 2: **EXAM I** (all material covered to date)
- Fri Feb 3: Age-structured models
- Tues Feb 7: Stage-structured models
- Thurs Feb 9: Stage-structured models
- Fri Feb 10: Stage-structured models
- Tues Feb 14: **CSF 2218** Numerical analysis of stage-structured models **Assignment 3 is assigned**
- Thurs Feb 16: Density dependence in stage-structured models
- Fri Feb 17: Metapopulation models

WINTER BREAK

- Tues Feb 28: Continuous space models **Assignment 3 is due**
- Thurs Mar 2: Spatially explicit models in population biology
- Fri Mar 3: Population dynamics in a warming world
- Tues Mar 7: Spatially explicit population dynamics in a warming world
- Thurs Mar 9: Disease dynamics
- Fri Mar 10: The net reproduction number
- Tues Mar 14: Overview of models in population biology
- Thurs Mar 16: **EXAM II** (All material since Exam I)
- Fri Mar 17: What is evolutionary ecology?
- Tues Mar 21: Haploid selection model 
- Thur Mar 23: [Selection coefficients for COVID-19 variants](https://www.zoology.ubc.ca/~otto/Talks/SSE2022_Otto.pdf)
- Fri Mar 24: **CSF 2218** Estimating selection coefficients **Assignment 4 is assigned**
- Tues Mar 28: The evolutionary ecology of pathogens
- Thurs Mar 30: The evolutionary ecology of COVID-19
- Fri Mar 31:  The evolutionary ecology of hosts **Assignment 4 is due**
- Tues Apr 3: The evolution of reproductive effort in plants
- Thurs Apr 5: Evolutionarily stable and convergent stable strategies
- Fri Apr 6: Review

TBD **FINAL EXAM** (all course material) 





<!--chapter:end:01-schedule.Rmd-->

# Jan 5: Introduction

- Survey of student computer preferences

## Some questions

- What is a population?
- What are some definitions of a population that are given in textbooks?
- In research studies, how are populations discussed in the _Discussion_?
- How are individuals that comprise the sample selected in the _Methods_ of a research study?
- List some potential differences between how populations are defined and discussed and the research methods?
- Why does the definition of a population matter?

## References

Vandermeer, J.H., Goldberg, D.E., 2013. Population Ecology: First Principles (Second Edition). Princeton University Press, Princeton, United States. [Link](https://ebookcentral-proquest-com.qe2a-proxy.mun.ca/lib/mun/detail.action?docID=1205619)

The Princeton Guide to Ecology, edited by Simon A. Levin, et al., Princeton University Press, 2009. ProQuest Ebook Central, [Link](https://ebookcentral-proquest-com.qe2a-proxy.mun.ca/lib/mun/detail.action?docID=557123)

Sacchi, R., Gentilli, A., Razzetti, E., Barbieri, F., 2002. Effects of building features on density and flock distribution of feral pigeons Columba livia var. domestica in an urban environment. Can. J. Zool. 80, 48-54. [Link](https://cdnsciencepub.com/doi/10.1139/z01-202)

<!--chapter:end:02-jan5-introduction.Rmd-->

# Jan 6: Discrete and continous variables

Reading: Otto, Sarah P., and Troy Day. 2007. A Biologist’s Guide to Mathematical Modeling in Ecology and Evolution, Princeton University Press. [Link](https://ebookcentral-proquest-com.qe2a-proxy.mun.ca/lib/mun/detail.action?docID=768551) **pages 33-38 in Section 2.3**

- Parameters versus variables

- Fitted versus independently estimated parameters

<!--chapter:end:03-jan6-discrete-continuous.Rmd-->

# Jan 12: **ASSIGNMENT** Rmarkdown and tidyverse 
(Dates changed owing to the university closure for a snow day)

ASSIGNMENT 1 due Jan 19.

PART I is to reproduce a figure and the figure caption of a plot in [Vandermeer and Goldberg 2013](https://ebookcentral-proquest-com.qe2a-proxy.mun.ca/lib/mun/detail.action?docID=1205619) or another textbook or a published paper in Rmarkdown and as an output file: .hmtl, .pdf, or .docx. Please choose a figure to reproduce in the area of Population Biology or Evolutionary Ecology.

You can simplify a complex figure if necessary. Your figure should be made in `ggplot()` have:
- the title (if there is one),
- axes labels,
- points or lines or both,
- approximately the same data as the original figure,
- the correct axes limits.

The objective is for you to learn how to use Rmarkdown to make a synthetic write-up that includes code, a figure and text. Your completed output should have:

1. A brief text description of where I can find the figure you reproduced.
2. Code that makes a figure that is suppressed in the output file.
3. The reproduced figure (or simplified figure).
4. The actual figure

You are to hand-in the .Rmd file and an output file (.html, .pdf, or .docx)

Here, is an example of what a completed PART 1 looks like (as an .html output).

---

The graph is Figure 3.1 from [Population Ecology: First Principles - Second Edition (Vandermeer and Goldberg)](https://ebookcentral-proquest-com.qe2a-proxy.mun.ca/lib/mun/detail.action?docID=1205619) on p67.

```{r, echo=F, message = F}
require(ggplot2)
age = seq(1,25)
difference = c(-20, -26, -24, -20, -22, -20, -10, 0,
               20, 23, 9, 5, 12, 14, 16, 10, 8, 6, 7, 11, 5, 6, 4, 5, 10)
data = data.frame(age=age, difference = difference)
g1=ggplot(data = data, aes(x = age, y = difference)) + 
  geom_point() +
  geom_line() +
  xlab("Adult Age, Days")+
  ylab("Difference")
g1
```

**FIGURE 3.1** Difference in per capita egg production between the O lines and B lines from Rose and Charlesworth's (1981) experiment.

```{r, echo=FALSE, out.width = '90%'}
knitr::include_graphics("figures/actual-fig.png")
```

---

Instructions to complete PART I are [here](#partI).

PART II: Messy data

As a biologist, much of my coding work involves getting data into the right format to use in functions, this might be a plot function like `ggplot()`, which you used in PART I, or a statistical function like `lm()`, which  will perform a regression, t-test, or analysis of variance. The objective of PART II is to practice cleaning messy data into a useable format.

[Download]() the messy data from [here](https://datacarpentry.org/semester-biology/exercises/Tidy-data-improving-messy-data-SQL/).



<!--chapter:end:04-jan10-Rmarkdown.Rmd-->

# Jan 13: Geometric growth

## Reading

Vandermeer, J.H., Goldberg, D.E., 2013. Population Ecology: First Principles (Second Edition). Princeton University Press, Princeton, United States. **p1-3.** [Link](https://ebookcentral-proquest-com.qe2a-proxy.mun.ca/lib/mun/detail.action?docID=1205619)

<!--chapter:end:05-jan12-geometric.Rmd-->

# Jan 17: Geometric growth

## Reading

Download the .pdf of the MSc thesis below and read the Abstract (the first two pages prior to the title page). Pay specific attention to the number of pheasants at different points in time, these might be $N_{t+1}$ and $N_t$ in the geometric growth model formula; and the number of births and deaths that occur, these may help you estimate $\lambda$ in the geoemtric growth formula. Pay attention to the length of time that births and deaths are reported over, and what time of the year the population size is reported.

Newcomb, HR. 1940. [Ring-necked pheasant studies on Protection Island in the Strait of Juan de Fuca](https://ir.library.oregonstate.edu/concern/graduate_thesis_or_dissertations/js956j801?locale=en), Washington. MS thesis. Oregon State University. [two pages prior to the title page]

Noteably,

a.	Pheasant chicks are born during the summer.
b.	In May 1937, 10 pheasants were introduced to the island. Before the next breeding season there were 35.
c.	November 10, 1938 a census estimated 110 pheasants.
d.	October 13, 1939 a census estimated 400 pheasants.
e.	Between the 1938 and 1939 censuses, Newcomb observed that 17 adult birds died.
f.	During the 1938 nesting season there were 5.86 eggs/nest. 83.57% of eggs hatched.
g.	During the 1939 nesting season there were 8.73 eggs/nest. 64.58% hatched.
h.	During the 1939 nesting season: Average number of chicks per clutch was 6.93.$^1$ 
i.	You can assume the sex ratio is 50:50 male to female. Pheasants are a sexually reproducing species.

$^1$ Note that g. and h. appear to be contradictory.

<!--chapter:end:06-jan13-geometric.Rmd-->

# PART I - Instructions {#partI .unlisted .unnumbered}

For general instructions on installing `R`, `RStudio` and installing packages see the [Quantitative Training Manual](https://ahurford.github.io/quant-guide-all-courses/).

- [Install](https://ahurford.github.io/quant-guide-all-courses/install.html) the `Rmarkdown` package and all dependencies.
- Install `tinytex`. In the past we have had some problems with this on PCs. If your `tinytex` installation fails, what you might try is a package manager for Windows, i.e. `Chocolatey` or `Scoop`. See [here](https://github.com/rstudio/tinytex-releases) for details. You are unsuccessful at installing `tinytex` that is okay, this package is only necessary to produce a .pdf output. You can complete your assignment as a .docx output or .html output.

<div class="alert alert-info">
**Why use R markdown?**

- Integrate code and write-up to avoid mistakes moving between `.R` (or other software) for analysis and `.docx` for write-up.

- It is easier to find all your work when everything is in one file (or linked to from one file).

- Run code in the background of your write-up so that if something changes the write-up automatically updates in all the relevant places. The reduces the chances of errors in your write-up.

- Publish your work as a website. This facilitates hyper-linking, you can update your work at any time, avoiding emailing your work keeps email storage free, and your work can be easily shared (i.e., in conversation I might say 'that analysis is linked off my faculty website').

- Include math symbols quickly because your hands don't leave the keyboard to make selections from drop-down menus.

- If your analysis is time-consuming you might not want the calculations in your write-up, slowing the compilation of your write-up. In this case you might have a separate `.R` analysis file that outputs your results as a `.csv` or plot. You can read these in automatically to your write-up by specifying the path to the `.csv` or plot.

</div>

1. In `R Studio`, select `File > New Project... > R Markdown`. Give the file a name, etc.

2. The default `.Rmd` opens already with some code to help you. With the default `.Rmd` opened, there should be a `Knit` button at the top and center of the Editor pane. Click the `Knit` button to knit to `.pdf`, `.html`, or `.docx` output. Alternatively, do `Cmd/Ctrl + Shift + K`.


```{r, echo=FALSE, out.width = '50%', fig.align='center'}
knitr::include_graphics("figures/Knit.png")
```

_(If this did not work, perhaps you have not installed the rmarkdown or tinytex packages)_

3. Beside the `Knit` button is an arrow. You have the option to knit to `.pdf`, `.html`, or `.docx` output. Try producing other outputs.

_(For me, producing a .docx opened Skype (clearly a bug). This was fixed by using Finder (on my Mac) to find the .docx file that I made, and selecting Open With > Microsoft Word)_

4. Below are some things to try, that will help you to complete PART I. Type the code, then `Knit` to see what happens.

- Include variables in-text by enclosing in `$x$`, i.e. this renders as $x$, which is italicized to indicate in your writing that $x$ is a variable rather than a letter.

- [Load data](https://ahurford.github.io/quant-guide-all-courses/data-entry.html#loading-or-importing-data) using R commands. _(If you want to do this quickly copy and paste the command at the end of this section)_

- [Hide the code](https://bookdown.org/yihui/rmarkdown/r-code.html) that loads the data in the output. i.e., read about the options for r code chunks: `echo`, `include`, `message`, `warning`, `eval`, and `results`. Print the data in your output. Show both the code and the output. Try it all!

```{r, include=FALSE,eval=TRUE}
data <- read.csv('https://raw.githubusercontent.com/ahurford/biol-4605-data/main/data/corn.csv', fill=TRUE)
x<-mean(data$Pcorn)
```

- Show only your code print out. Can you do this?
```{r, results=T, echo=FALSE}
head(data)
```

- Include code in-text as `` `r "\u0060r x \u0060"` ``. This renders as `r x` because in a hidden coding block I loaded data and assigned `x<-mean(data$Pcorn)`. Therefore, the reported value of $x$ = `r x` is the mean phosphorous in the soil for the data I loaded in the background. If the data change, the mean reported in this document will automatically change too.

- Make [headings, subheadings](https://bookdown.org/yihui/rmarkdown/markdown-syntax.html#block-level-elements), [bold font](https://bookdown.org/yihui/rmarkdown/markdown-syntax.html#inline-formatting), etc.

- Make a [hyperlink](https://bookdown.org/yihui/rmarkdown/markdown-syntax.html#inline-formatting).

- Use latex commands to include in-text equations, i.e., `$y = \beta_0 + \beta_1 x$` renders as $y = \beta_0 + \beta_1 x$; `$\frac{dy}{dt} = e^x$` renders as $\frac{dy}{dt} = e^x$. _(You may need to type `require(tinytex)` in the Console to get this to work. `The website [Detexify](https://detexify.kirelabs.org/classify.html) is fun for identifying latex commands for different symbols (Some advanced symbols may require packages that you haven't installed and therfore won't work))_.

- Try some [more complicated](https://bookdown.org/yihui/rmarkdown/markdown-syntax.html#math-expressions) Latex.


```{r}
data <- read.csv('https://raw.githubusercontent.com/ahurford/biol-4605-data/main/data/corn.csv', fill=TRUE)
```

- If you would like a more structured introduction to R Markdown you can read [R Markdown: the definitive guide](https://bookdown.org/yihui/rmarkdown/).

- This [R markdown cheat sheet](https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf)  is helpful.

- Some more advanced skills you might learn are making alert boxes, or changing some of the options in the [YAML](https://bookdown.org/yihui/rmarkdown/html-document.html). The alert boxes in this document are made as `div class="alert alert-info"` between `< >`, then the text, and closed with `/div` between `< >`.

- My experience making tables in `.Rmd` has not been good. Usually, I make the table in `.docx`, print to `.pdf`, take a screenshot and import the `.png` to `.Rmd` or `.tex`.

5. For your PART I specifically, you need to make a figure in `ggplot`. For `ggplot` you need your data as a data frame. The code that I used in the example was:

```{r}
age = seq(1,25)
difference = c(-20, -26, -24, -20, -22, -20, -10, 0,
               20, 23, 9, 5, 12, 14, 16, 10, 8, 6, 7, 11, 5, 6, 4, 5, 10)
data = data.frame(age=age, difference = difference)
```

As you can see, I have guessed the values in the plot and entered them manually. This is okay for the purposes of completing your assignment. (Extra for experts - try a package like [`scrapR`](https://github.com/adamkucharski/scrapR) or [`digitize`](https://github.com/tpoisot/digitize)).

6. You need to install `ggplot2`. You also need to load that package because we are going to use functions from it now (do this as `require(ggplot2)`). The code that I used to make my `ggplot` was:

```{r}
g1=ggplot(data = data, aes(x = age, y = difference)) + 
  geom_point() +
  geom_line() +
  xlab("Adult Age, Days")+
  ylab("Difference")
g1
```

If you need to add a title, you can add a layer `+ ggtitle("Your title)`, to control the axis limits, use `+ xlim(c(-10,10))` (with the values you need). Generally, you should be able to use an internet search to find what you need. You can also read more about `ggplot` [here](https://ahurford.github.io/quant-guide-all-courses/ggplot.html).

7. To make your figure caption, just type below where your figure prints. To get bold text, use ** bold text ** (but without space between the ** and the text).

8. The last thing we need is to take a screenshot of the figure you are trying to reproduce, and to include it as a figure. I like to put all my figures in a folder named figure. You can read about including a [figure](https://bookdown.org/yihui/rmarkdown/r-code.html#figures) that is a `.png` or other format. Of the options, I find using knitr::include_graphics() within a code chunk best because it seems easier to control the figure size. The code that I used in my example of how I completed PART I was:

```{r, echo=FALSE, out.width = '90%'}
knitr::include_graphics("figures/actual-fig.png")
```

Now you have all the information you need to complete PART I, you just need to put the pieces together. If you are stuck, ask me or a classmate.

<!--chapter:end:Part-I-instructions.Rmd-->

