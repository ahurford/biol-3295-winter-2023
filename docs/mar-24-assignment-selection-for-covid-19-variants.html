<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>23 Mar 24 ASSIGNMENT Selection for COVID-19 variants | BIOL 3295: Population and Evolutionary Ecology, Winter 2023</title>
  <meta name="description" content="23 Mar 24 ASSIGNMENT Selection for COVID-19 variants | BIOL 3295: Population and Evolutionary Ecology, Winter 2023" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="23 Mar 24 ASSIGNMENT Selection for COVID-19 variants | BIOL 3295: Population and Evolutionary Ecology, Winter 2023" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="23 Mar 24 ASSIGNMENT Selection for COVID-19 variants | BIOL 3295: Population and Evolutionary Ecology, Winter 2023" />
  
  
  

<meta name="author" content="Amy Hurford" />


<meta name="date" content="2023-03-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mar-23-haploid-selection-model.html"/>
<link rel="next" href="mar-28-30-evolutionary-ecology-of-pathogens.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Syllabus</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#instructor-information"><i class="fa fa-check"></i><b>1.1</b> Instructor Information</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-information"><i class="fa fa-check"></i><b>1.2</b> Course Information</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#method-of-evaluation"><i class="fa fa-check"></i><b>1.3</b> Method of Evaluation</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#additional-policies"><i class="fa fa-check"></i><b>1.4</b> Additional Policies</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#accommodation-of-students-with-disabilities"><i class="fa fa-check"></i><b>1.4.1</b> Accommodation of students with disabilities</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#academic-misconduct"><i class="fa fa-check"></i><b>1.4.2</b> Academic misconduct</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#equity-and-diversity"><i class="fa fa-check"></i><b>1.4.3</b> Equity and Diversity</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#additional-supports"><i class="fa fa-check"></i><b>1.5</b> Additional Supports</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="schedule.html"><a href="schedule.html"><i class="fa fa-check"></i><b>2</b> Schedule</a></li>
<li class="chapter" data-level="3" data-path="jan-5-introduction.html"><a href="jan-5-introduction.html"><i class="fa fa-check"></i><b>3</b> Jan 5: Introduction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="jan-5-introduction.html"><a href="jan-5-introduction.html#some-questions"><i class="fa fa-check"></i><b>3.1</b> Some questions</a></li>
<li class="chapter" data-level="3.2" data-path="jan-5-introduction.html"><a href="jan-5-introduction.html#references"><i class="fa fa-check"></i><b>3.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="jan-6-discrete-and-continous-variables.html"><a href="jan-6-discrete-and-continous-variables.html"><i class="fa fa-check"></i><b>4</b> Jan 6: Discrete and continous variables</a></li>
<li class="chapter" data-level="5" data-path="jan-12-assignment-rmarkdown-and-tidyverse.html"><a href="jan-12-assignment-rmarkdown-and-tidyverse.html"><i class="fa fa-check"></i><b>5</b> Jan 12: <strong>ASSIGNMENT</strong> Rmarkdown and tidyverse</a></li>
<li class="chapter" data-level="6" data-path="jan-13-geometric-growth.html"><a href="jan-13-geometric-growth.html"><i class="fa fa-check"></i><b>6</b> Jan 13: Geometric growth</a>
<ul>
<li class="chapter" data-level="6.1" data-path="jan-13-geometric-growth.html"><a href="jan-13-geometric-growth.html#reading"><i class="fa fa-check"></i><b>6.1</b> Reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="pheasant.html"><a href="pheasant.html"><i class="fa fa-check"></i><b>7</b> Jan 17: Geometric growth</a>
<ul>
<li class="chapter" data-level="7.1" data-path="pheasant.html"><a href="pheasant.html#reading-1"><i class="fa fa-check"></i><b>7.1</b> Reading</a></li>
<li class="chapter" data-level="7.2" data-path="pheasant.html"><a href="pheasant.html#questions"><i class="fa fa-check"></i><b>7.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="estimate.html"><a href="estimate.html"><i class="fa fa-check"></i><b>8</b> Jan 19: <strong>ASSIGNMENT</strong> Estimating the geometric growth rate</a>
<ul>
<li class="chapter" data-level="8.1" data-path="estimate.html"><a href="estimate.html#code"><i class="fa fa-check"></i><b>8.1</b> Code</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="estimate.html"><a href="estimate.html#loading-and-plotting-the-data"><i class="fa fa-check"></i><b>8.1.1</b> Loading and plotting the data</a></li>
<li class="chapter" data-level="8.1.2" data-path="estimate.html"><a href="estimate.html#function-for-geometric-growth"><i class="fa fa-check"></i><b>8.1.2</b> Function for geometric growth</a></li>
<li class="chapter" data-level="8.1.3" data-path="estimate.html"><a href="estimate.html#fitting-lambda"><i class="fa fa-check"></i><b>8.1.3</b> Fitting lambda</a></li>
<li class="chapter" data-level="8.1.4" data-path="estimate.html"><a href="estimate.html#plotting-the-fit"><i class="fa fa-check"></i><b>8.1.4</b> Plotting the fit</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="estimate.html"><a href="estimate.html#to-hand-in"><i class="fa fa-check"></i><b>8.2</b> To hand in</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="exponential.html"><a href="exponential.html"><i class="fa fa-check"></i><b>9</b> Jan 20: Exponential growth</a>
<ul>
<li class="chapter" data-level="9.1" data-path="exponential.html"><a href="exponential.html#required-reading"><i class="fa fa-check"></i><b>9.1</b> Required reading</a></li>
<li class="chapter" data-level="9.2" data-path="exponential.html"><a href="exponential.html#discrete-or-continuous-time-formulations"><i class="fa fa-check"></i><b>9.2</b> Discrete or continuous time formulations</a></li>
<li class="chapter" data-level="9.3" data-path="exponential.html"><a href="exponential.html#questions-1"><i class="fa fa-check"></i><b>9.3</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="dd.html"><a href="dd.html"><i class="fa fa-check"></i><b>10</b> Jan 24: Density dependent growth</a>
<ul>
<li class="chapter" data-level="10.1" data-path="dd.html"><a href="dd.html#required-reading-1"><i class="fa fa-check"></i><b>10.1</b> Required reading</a></li>
<li class="chapter" data-level="10.2" data-path="dd.html"><a href="dd.html#questions-2"><i class="fa fa-check"></i><b>10.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="jan-26-density-dependence.html"><a href="jan-26-density-dependence.html"><i class="fa fa-check"></i><b>11</b> Jan 26: Density dependence</a></li>
<li class="chapter" data-level="12" data-path="jan-27-density-dependence-discrete-time.html"><a href="jan-27-density-dependence-discrete-time.html"><i class="fa fa-check"></i><b>12</b> Jan 27: Density dependence (discrete time)</a>
<ul>
<li class="chapter" data-level="12.1" data-path="jan-27-density-dependence-discrete-time.html"><a href="jan-27-density-dependence-discrete-time.html#required-reading-2"><i class="fa fa-check"></i><b>12.1</b> Required reading</a></li>
<li class="chapter" data-level="12.2" data-path="jan-27-density-dependence-discrete-time.html"><a href="jan-27-density-dependence-discrete-time.html#questions-3"><i class="fa fa-check"></i><b>12.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="feb-16-stage-structure.html"><a href="feb-16-stage-structure.html"><i class="fa fa-check"></i><b>13</b> Feb 16: Stage structure</a>
<ul>
<li class="chapter" data-level="13.1" data-path="feb-16-stage-structure.html"><a href="feb-16-stage-structure.html#required-reading-3"><i class="fa fa-check"></i><b>13.1</b> Required Reading</a></li>
<li class="chapter" data-level="13.2" data-path="feb-16-stage-structure.html"><a href="feb-16-stage-structure.html#questions-4"><i class="fa fa-check"></i><b>13.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="feb-17-assignment-stage-structured-population-dynamics.html"><a href="feb-17-assignment-stage-structured-population-dynamics.html"><i class="fa fa-check"></i><b>14</b> Feb 17: <strong>ASSIGNMENT</strong> Stage-structured population dynamics</a></li>
<li class="chapter" data-level="15" data-path="feb-28-stage-structured-population-dynamics.html"><a href="feb-28-stage-structured-population-dynamics.html"><i class="fa fa-check"></i><b>15</b> Feb 28: Stage-structured population dynamics</a>
<ul>
<li class="chapter" data-level="15.1" data-path="feb-28-stage-structured-population-dynamics.html"><a href="feb-28-stage-structured-population-dynamics.html#required-reading-4"><i class="fa fa-check"></i><b>15.1</b> Required Reading</a></li>
<li class="chapter" data-level="15.2" data-path="feb-28-stage-structured-population-dynamics.html"><a href="feb-28-stage-structured-population-dynamics.html#questions-5"><i class="fa fa-check"></i><b>15.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="mar-2-eigenvalues-and-eigenvectors.html"><a href="mar-2-eigenvalues-and-eigenvectors.html"><i class="fa fa-check"></i><b>16</b> Mar 2: Eigenvalues and eigenvectors</a>
<ul>
<li class="chapter" data-level="16.1" data-path="mar-2-eigenvalues-and-eigenvectors.html"><a href="mar-2-eigenvalues-and-eigenvectors.html#required-reading-5"><i class="fa fa-check"></i><b>16.1</b> Required Reading</a></li>
<li class="chapter" data-level="16.2" data-path="mar-2-eigenvalues-and-eigenvectors.html"><a href="mar-2-eigenvalues-and-eigenvectors.html#questions-6"><i class="fa fa-check"></i><b>16.2</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="mar-3-sensitivity-parameterization-and-density-dependence-and-stage-structured-population-dynamics.html"><a href="mar-3-sensitivity-parameterization-and-density-dependence-and-stage-structured-population-dynamics.html"><i class="fa fa-check"></i><b>17</b> Mar 3: Sensitivity, parameterization, and density-dependence and stage-structured population dynamics</a>
<ul>
<li class="chapter" data-level="17.1" data-path="mar-3-sensitivity-parameterization-and-density-dependence-and-stage-structured-population-dynamics.html"><a href="mar-3-sensitivity-parameterization-and-density-dependence-and-stage-structured-population-dynamics.html#required-reading-6"><i class="fa fa-check"></i><b>17.1</b> Required reading</a></li>
<li class="chapter" data-level="17.2" data-path="mar-3-sensitivity-parameterization-and-density-dependence-and-stage-structured-population-dynamics.html"><a href="mar-3-sensitivity-parameterization-and-density-dependence-and-stage-structured-population-dynamics.html#reference-that-will-be-covered-in-class"><i class="fa fa-check"></i><b>17.2</b> Reference that will be covered in class</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="mar-7-metapopulation-models.html"><a href="mar-7-metapopulation-models.html"><i class="fa fa-check"></i><b>18</b> Mar 7: Metapopulation models</a>
<ul>
<li class="chapter" data-level="18.1" data-path="mar-7-metapopulation-models.html"><a href="mar-7-metapopulation-models.html#required-reading-7"><i class="fa fa-check"></i><b>18.1</b> Required Reading</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="mar-9-continuous-space-models.html"><a href="mar-9-continuous-space-models.html"><i class="fa fa-check"></i><b>19</b> Mar 9: Continuous space models</a></li>
<li class="chapter" data-level="20" data-path="mar-10-14-epidemiology.html"><a href="mar-10-14-epidemiology.html"><i class="fa fa-check"></i><b>20</b> Mar 10 &amp; 14: Epidemiology</a>
<ul>
<li class="chapter" data-level="20.1" data-path="mar-10-14-epidemiology.html"><a href="mar-10-14-epidemiology.html#required-reading-8"><i class="fa fa-check"></i><b>20.1</b> Required reading</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="mar-21-what-is-evolutionary-ecology.html"><a href="mar-21-what-is-evolutionary-ecology.html"><i class="fa fa-check"></i><b>21</b> Mar 21 What is evolutionary ecology?</a>
<ul>
<li class="chapter" data-level="21.1" data-path="mar-21-what-is-evolutionary-ecology.html"><a href="mar-21-what-is-evolutionary-ecology.html#required-reading-9"><i class="fa fa-check"></i><b>21.1</b> Required reading</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="mar-23-haploid-selection-model.html"><a href="mar-23-haploid-selection-model.html"><i class="fa fa-check"></i><b>22</b> Mar 23 Haploid selection model</a>
<ul>
<li class="chapter" data-level="22.1" data-path="mar-23-haploid-selection-model.html"><a href="mar-23-haploid-selection-model.html#required-reading-10"><i class="fa fa-check"></i><b>22.1</b> Required reading</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="mar-24-assignment-selection-for-covid-19-variants.html"><a href="mar-24-assignment-selection-for-covid-19-variants.html"><i class="fa fa-check"></i><b>23</b> Mar 24 <strong>ASSIGNMENT</strong> Selection for COVID-19 variants</a></li>
<li class="chapter" data-level="24" data-path="mar-28-30-evolutionary-ecology-of-pathogens.html"><a href="mar-28-30-evolutionary-ecology-of-pathogens.html"><i class="fa fa-check"></i><b>24</b> Mar 28 &amp; 30 Evolutionary ecology of pathogens</a></li>
<li class="chapter" data-level="25" data-path="mar-31-evolution-of-virulence-for-sars-cov-2.html"><a href="mar-31-evolution-of-virulence-for-sars-cov-2.html"><i class="fa fa-check"></i><b>25</b> Mar 31 Evolution of virulence for SARS-CoV-2</a>
<ul>
<li class="chapter" data-level="" data-path="mar-31-evolution-of-virulence-for-sars-cov-2.html"><a href="mar-31-evolution-of-virulence-for-sars-cov-2.html#relevant-readings"><i class="fa fa-check"></i>Relevant readings</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="schedule-old.html"><a href="schedule-old.html"><i class="fa fa-check"></i><b>26</b> Schedule - prior to strike - outdated</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIOL 3295: Population and Evolutionary Ecology, Winter 2023</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mar-24-assignment-selection-for-covid-19-variants" class="section level1 hasAnchor" number="23">
<h1><span class="header-section-number">23</span> Mar 24 <strong>ASSIGNMENT</strong> Selection for COVID-19 variants<a href="mar-24-assignment-selection-for-covid-19-variants.html#mar-24-assignment-selection-for-covid-19-variants" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Class will be in CSF 2238.</p>
<p>Visit the CoVaRRnet’s website for <a href="https://covarr-net.github.io/duotang/duotang.html">duotang</a></p>
<p>Below is an analysis that estimates the selection coefficient related to this plot estimating the selection coefficients for the BQ* and XBB* variants relative to each other for all of Canada:</p>
<p><img src="figures/selection1.png" width="90%" /></p>
<p>Note that BQ* and XBB* are aggregations of finer variant classifications.</p>
<p><strong>ASSIGNMENT 4: Your assignment is to write an .Rmd notebook that estimates the selection coefficient for a subvariant. You need to include a graph, and state your estimate of the selection coefficient. This assignment is due FRIDAY MARCH 31</strong></p>
<p>The duotong website contains several of the graphs for the other variants and/or regions to give you an idea of how data rich your chosen analysis might be before you start it.</p>
<p>First we load the packages we will need:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;dplyr&quot;</span>)</span>
<span id="cb48-2"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span></code></pre></div>
<p>The data can be download from Duotang. You can do this by clicking on <em>Frequency table download</em>. However, I have already downloaded the data and uploaded it to a website so it can also be loaded into <code>R</code> as follows:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb49-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read.delim</span>(<span class="st">&quot;https://raw.githubusercontent.com/ahurford/biol-4605-data/main/data2/Last%20120%20days.tsv&quot;</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p>Note that the file is <code>.tsv</code> format, so I needed to look up what <code>R</code> function could read that in.</p>
<p>Now that the data is loaded, the challenge in replicating the analysis, is cleaning the data up into the right form so that we can do the linear regression. We use the <code>tidyr</code> package commands to clean our data. It may be very helpful to review the tidyr commands <a href="https://ahurford.github.io/quant-guide-all-courses/handling-data.html#dplyr">here</a>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb50-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> data<span class="sc">%&gt;%</span><span class="fu">rename</span>(<span class="at">percent =</span> X..Frequency)</span></code></pre></div>
<p>The code above renames a column to make it a bit easier to work with in subsequent coding.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb51-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Frequency<span class="ot">=</span><span class="fu">as.numeric</span>(data<span class="sc">$</span>Frequency)</span>
<span id="cb51-2"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb51-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Date <span class="ot">=</span> <span class="fu">as.Date</span>(data<span class="sc">$</span>Date)</span>
<span id="cb51-3"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb51-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>percent <span class="ot">=</span><span class="fu">as.numeric</span>(<span class="fu">sub</span>(<span class="st">&quot;%&quot;</span>, <span class="st">&quot;&quot;</span>, data<span class="sc">$</span>percent))</span></code></pre></div>
<p>The above commands are to correctly designate the type of variables in the columns. Generally, dates don’t read in as dates, and you need to explicitly state that they are dates using <code>as.Date()</code> before <code>R</code> will treat them as such. When data is stored with a <code>%</code>, then <code>R</code> tends initially understand that as a word, and fails to complete problems such as <code>10% + 10%</code> until we remove the <code>%</code> and tag the resulting quantity as a number.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb52-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> data<span class="sc">$</span>Date, <span class="at">Number =</span> data<span class="sc">$</span>Frequency, <span class="at">Lineage =</span> data<span class="sc">$</span>Lineage)</span>
<span id="cb52-2"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb52-3" aria-hidden="true" tabindex="-1"></a>g1<span class="ot">=</span><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Number, <span class="at">fill=</span>Lineage)) <span class="sc">+</span> </span>
<span id="cb52-4"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>)<span class="sc">+</span></span>
<span id="cb52-5"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">rainbow</span>(<span class="dv">26</span>))</span>
<span id="cb52-6"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb52-6" aria-hidden="true" tabindex="-1"></a>g1</span></code></pre></div>
<p><img src="BIOL-3295_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<p>(I even tried to replicate the color palette of the plot, however, that didn’t work and the colors are a bit ghastly!)</p>
<p>To replicate the plot I am trying to replicate, I need to aggregate some lineages. (This may not be necessary for your analysis. Additionally, there may be a more elegant way of achieve the same thing. Below, is what worked for me).</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-1" aria-hidden="true" tabindex="-1"></a>data2<span class="ot">=</span>data<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">group=</span><span class="fu">case_when</span>(Lineage <span class="sc">==</span> <span class="st">&quot;BQ.1&quot;</span> <span class="sc">~</span> <span class="st">&quot;BQ*&quot;</span>,</span>
<span id="cb53-2"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-2" aria-hidden="true" tabindex="-1"></a>                                    Lineage <span class="sc">==</span> <span class="st">&quot;BQ.1.1&quot;</span> <span class="sc">~</span> <span class="st">&quot;BQ*&quot;</span>,</span>
<span id="cb53-3"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-3" aria-hidden="true" tabindex="-1"></a>                                    Lineage<span class="sc">==</span><span class="st">&quot;BQ.1.1.1&quot;</span> <span class="sc">~</span> <span class="st">&quot;BQ*&quot;</span>,</span>
<span id="cb53-4"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-4" aria-hidden="true" tabindex="-1"></a>                                    Lineage<span class="sc">==</span><span class="st">&quot;BQ.1.1.18&quot;</span> <span class="sc">~</span> <span class="st">&quot;BQ*&quot;</span>,</span>
<span id="cb53-5"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-5" aria-hidden="true" tabindex="-1"></a>                                    Lineage<span class="sc">==</span><span class="st">&quot;BQ.1.1.3&quot;</span> <span class="sc">~</span> <span class="st">&quot;BQ*&quot;</span>,</span>
<span id="cb53-6"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-6" aria-hidden="true" tabindex="-1"></a>                                    Lineage<span class="sc">==</span><span class="st">&quot;BQ.1.1.4&quot;</span> <span class="sc">~</span> <span class="st">&quot;BQ*&quot;</span>,</span>
<span id="cb53-7"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-7" aria-hidden="true" tabindex="-1"></a>                                    Lineage<span class="sc">==</span><span class="st">&quot;BQ.1.1.5&quot;</span> <span class="sc">~</span> <span class="st">&quot;BQ*&quot;</span>,</span>
<span id="cb53-8"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-8" aria-hidden="true" tabindex="-1"></a>                                    Lineage<span class="sc">==</span><span class="st">&quot;BQ.1.10.1&quot;</span><span class="sc">~</span> <span class="st">&quot;BQ*&quot;</span>,</span>
<span id="cb53-9"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-9" aria-hidden="true" tabindex="-1"></a>                                    Lineage<span class="sc">==</span><span class="st">&quot;BQ.1.12&quot;</span><span class="sc">~</span><span class="st">&quot;BQ*&quot;</span>,</span>
<span id="cb53-10"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-10" aria-hidden="true" tabindex="-1"></a>                                    Lineage<span class="sc">==</span><span class="st">&quot;BQ.1.13&quot;</span><span class="sc">~</span> <span class="st">&quot;BQ*&quot;</span>,</span>
<span id="cb53-11"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-11" aria-hidden="true" tabindex="-1"></a>                                    Lineage<span class="sc">==</span><span class="st">&quot;BQ.1.14&quot;</span><span class="sc">~</span> <span class="st">&quot;BQ*&quot;</span>,</span>
<span id="cb53-12"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-12" aria-hidden="true" tabindex="-1"></a>                                    Lineage<span class="sc">==</span><span class="st">&quot;BQ.1.2&quot;</span><span class="sc">~</span> <span class="st">&quot;BQ*&quot;</span>,</span>
<span id="cb53-13"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-13" aria-hidden="true" tabindex="-1"></a>                                    Lineage<span class="sc">==</span><span class="st">&quot;BQ.1.25&quot;</span><span class="sc">~</span> <span class="st">&quot;BQ*&quot;</span>,</span>
<span id="cb53-14"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-14" aria-hidden="true" tabindex="-1"></a>                                    Lineage<span class="sc">==</span><span class="st">&quot;BQ.1.3&quot;</span><span class="sc">~</span> <span class="st">&quot;BQ*&quot;</span>,</span>
<span id="cb53-15"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-15" aria-hidden="true" tabindex="-1"></a>                                    Lineage<span class="sc">==</span><span class="st">&quot;BQ.1.5&quot;</span><span class="sc">~</span> <span class="st">&quot;BQ*&quot;</span>,</span>
<span id="cb53-16"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-16" aria-hidden="true" tabindex="-1"></a>                                    Lineage<span class="sc">==</span><span class="st">&quot;XBB.1&quot;</span><span class="sc">~</span> <span class="st">&quot;XBB*&quot;</span>,</span>
<span id="cb53-17"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-17" aria-hidden="true" tabindex="-1"></a>                                    Lineage<span class="sc">==</span><span class="st">&quot;XBB.1.5&quot;</span><span class="sc">~</span> <span class="st">&quot;XBB*&quot;</span>,</span>
<span id="cb53-18"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-18" aria-hidden="true" tabindex="-1"></a>                              ))</span>
<span id="cb53-19"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data2,<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##          Date         Lineage Frequency percent group
## 1  2022-11-07  other lineages       799      36  &lt;NA&gt;
## 2  2022-11-07          BA.4.6       116       5  &lt;NA&gt;
## 3  2022-11-07          BA.5.1       111       5  &lt;NA&gt;
## 4  2022-11-07          BA.5.2       185       8  &lt;NA&gt;
## 5  2022-11-07        BA.5.2.1       260      12  &lt;NA&gt;
## 6  2022-11-07       BA.5.2.13        25       1  &lt;NA&gt;
## 7  2022-11-07        BE.1.2.1        27       1  &lt;NA&gt;
## 8  2022-11-07            BF.7       122       5  &lt;NA&gt;
## 9  2022-11-07            BQ.1       131       6   BQ*
## 10 2022-11-07          BQ.1.1       233      10   BQ*</code></pre>
<p>This has created a new column called <code>group</code>. I need to filter out just the BQ* and XBB* variants, and I need to sum the proportions attributed to each of the lineages aggregated into BQ* or XBB* (such aggregation may not be needed for your analysis).</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb55-1" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">=</span> data2<span class="sc">%&gt;%</span><span class="fu">group_by</span>(group,Date) <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_prop=</span><span class="fu">sum</span>(percent)<span class="sc">/</span><span class="dv">100</span>)<span class="sc">%&gt;%</span><span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">&quot;XBB*&quot;</span><span class="sc">|</span>group<span class="sc">==</span><span class="st">&quot;BQ*&quot;</span>)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by
## &#39;group&#39;. You can override using the
## `.groups` argument.</code></pre>
<p>Additionally, I need to calculate the logarithm of the proportion of the variants, and filter out any reports of 0 because the logarithm of 0 is undefined. Also, here, I need to convert from percentage to proportion.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb57-1" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">=</span> data2<span class="sc">%&gt;%</span><span class="fu">filter</span>(total_prop<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="at">log_percent =</span> <span class="fu">log</span>(total_prop))</span></code></pre></div>
<p>Make a plot:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb58-1" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">=</span><span class="fu">ggplot</span>(data2, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> total_prop, <span class="at">group=</span>group, <span class="at">colour=</span>group)) <span class="sc">+</span> </span>
<span id="cb58-2"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb58-3"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb58-4"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&#39;proportion of all variants&#39;</span>)</span>
<span id="cb58-5"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb58-5" aria-hidden="true" tabindex="-1"></a>g3</span></code></pre></div>
<p><img src="BIOL-3295_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>I want to do the linear regression, but to do this I ended up splitting out the XBB* and QB* variants:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb59-1" aria-hidden="true" tabindex="-1"></a>XBB <span class="ot">=</span> <span class="fu">filter</span>(data2, group <span class="sc">==</span> <span class="st">&quot;XBB*&quot;</span>)</span>
<span id="cb59-2"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb59-2" aria-hidden="true" tabindex="-1"></a>BQ <span class="ot">=</span> <span class="fu">filter</span>(data2, group <span class="sc">==</span> <span class="st">&quot;BQ*&quot;</span>)</span></code></pre></div>
<p>Below, we perform the linear regressions:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb60-1" aria-hidden="true" tabindex="-1"></a>lm.XBB <span class="ot">=</span> <span class="fu">lm</span>(log_percent <span class="sc">~</span> Date,<span class="at">data=</span>XBB)</span>
<span id="cb60-2"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb60-2" aria-hidden="true" tabindex="-1"></a>lm.BQ <span class="ot">=</span> <span class="fu">lm</span>(log_percent <span class="sc">~</span> Date,<span class="at">data=</span>BQ)</span></code></pre></div>
<p>To plot the linear regressions, and the 95% confidence interval, we use the <code>predict()</code> function on the linear regression objects, <code>lm.XBB</code> and <code>lm.BQ</code>.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb61-1" aria-hidden="true" tabindex="-1"></a>PI.XBB <span class="ot">=</span> <span class="fu">predict</span>(lm.XBB, <span class="at">se.fit=</span><span class="cn">TRUE</span>, <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>, <span class="at">level=</span><span class="fl">0.95</span>)<span class="sc">$</span>fit</span>
<span id="cb61-2"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb61-2" aria-hidden="true" tabindex="-1"></a>PI.BQ <span class="ot">=</span> <span class="fu">predict</span>(lm.BQ, <span class="at">se.fit=</span><span class="cn">TRUE</span>, <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>, <span class="at">level=</span><span class="fl">0.95</span>)<span class="sc">$</span>fit</span></code></pre></div>
<p>Below, I organize the data, and the linear regression outputs into a data frame to make a plot:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb62-1" aria-hidden="true" tabindex="-1"></a>XBB.fit <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> XBB<span class="sc">$</span>Date, <span class="at">fit =</span> PI.XBB[,<span class="dv">1</span>], <span class="at">lwr =</span> PI.XBB[,<span class="dv">2</span>], <span class="at">uppr =</span> PI.XBB[,<span class="dv">3</span>])</span>
<span id="cb62-2"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb62-2" aria-hidden="true" tabindex="-1"></a>BQ.fit <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Date =</span> BQ<span class="sc">$</span>Date, <span class="at">fit =</span> PI.BQ[,<span class="dv">1</span>], <span class="at">lwr =</span> PI.BQ[,<span class="dv">2</span>], <span class="at">uppr =</span> PI.BQ[,<span class="dv">3</span>])</span>
<span id="cb62-3"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb62-4" aria-hidden="true" tabindex="-1"></a>g4<span class="ot">=</span><span class="fu">ggplot</span>(<span class="at">data=</span>XBB.fit, <span class="fu">aes</span>(<span class="at">x=</span>Date))<span class="sc">+</span></span>
<span id="cb62-5"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr, <span class="at">ymax=</span>uppr, <span class="at">fill =</span> <span class="st">&quot;#F8766D&quot;</span>), <span class="at">alpha =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb62-6"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>fit), <span class="at">color =</span> <span class="st">&quot;#F8766D&quot;</span>)<span class="sc">+</span></span>
<span id="cb62-7"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>log_percent), <span class="at">data=</span>BQ, <span class="at">color =</span> <span class="st">&quot;#00BA38&quot;</span>)<span class="sc">+</span></span>
<span id="cb62-8"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr, <span class="at">ymax=</span>uppr, <span class="at">fill =</span> <span class="st">&quot;#00BA38&quot;</span>), <span class="at">alpha =</span> <span class="fl">0.1</span>, <span class="at">data=</span>BQ.fit)<span class="sc">+</span></span>
<span id="cb62-9"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>fit), <span class="at">data =</span> BQ.fit, <span class="at">color=</span><span class="st">&quot;#00BA38&quot;</span>)<span class="sc">+</span></span>
<span id="cb62-10"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>log_percent), <span class="at">data=</span>XBB,  <span class="at">color =</span> <span class="st">&quot;#F8766D&quot;</span>)<span class="sc">+</span></span>
<span id="cb62-11"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;log(proportion of all variants)&quot;</span>)</span>
<span id="cb62-12"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb62-12" aria-hidden="true" tabindex="-1"></a>  g4</span></code></pre></div>
<p><img src="BIOL-3295_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>That is a good plot, but we still need to know the slope of the regression to estimate the selection coefficients for the variants:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.XBB)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log_percent ~ Date, data = XBB)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.57728 -0.19989  0.01419  0.21737  0.41425 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -9.663e+02  5.633e+01  -17.15 8.31e-10 ***
## Date         4.976e-02  2.908e-03   17.11 8.55e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3071 on 12 degrees of freedom
## Multiple R-squared:  0.9606, Adjusted R-squared:  0.9573 
## F-statistic: 292.8 on 1 and 12 DF,  p-value: 8.545e-10</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="mar-24-assignment-selection-for-covid-19-variants.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.BQ)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log_percent ~ Date, data = BQ)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.63967 -0.24884  0.09348  0.20036  0.28267 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept)  1.3785411 36.8420520   0.037    0.971
## Date        -0.0001081  0.0019031  -0.057    0.955
## 
## Residual standard error: 0.2691 on 15 degrees of freedom
## Multiple R-squared:  0.0002149,  Adjusted R-squared:  -0.06644 
## F-statistic: 0.003224 on 1 and 15 DF,  p-value: 0.9555</code></pre>
<p>This tells me the slope of my regression for the XBB* variant is 0.05 and the intercept is -966.29. For the BQ* variant, the slope is 0 and the intercept is 1.379. You can get these values to print out in your Rmarkdown by writing <code>round(coef(lm.BQ)[1],3)</code> (for example) but enclosed within downward dashes, and where the first dash is followed by <code>r</code>.</p>
<p>These estimates of the slope are close to the slope of <code>0.08</code> for XBB* and <code>0.02</code> for BQ* shown in the figure. I expect they are not exact, because the data shown in the figure is more finely resolved on the <code>Date</code> axis than the data that could be downloaded.</p>
<p>The selection coefficient is the slope of this regression, see <a href="https://www.zoology.ubc.ca/~otto/Talks/SSE2022_Otto.pdf">slide</a> 23. The selection coefficient is <span class="math inline">\(s_{XBB*} = r_{XBB*} - r_{all}\)</span>, where <span class="math inline">\(r_i\)</span> is the exponential growth rate of the <span class="math inline">\(i\)</span> variant.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="mar-23-haploid-selection-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mar-28-30-evolutionary-ecology-of-pathogens.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BIOL-3295.epub"],
"search": {
"engine": "fuse",
"options": null
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
